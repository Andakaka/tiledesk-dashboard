<div class="navbar-brand" style="z-index: -1;margin-top:10px; padding-left:30px">
  <i class="material-icons" style="vertical-align: middle !important; cursor: pointer;" (click)="goBackToRequestsList()">keyboard_arrow_left</i>
  Request <code style="color:#3f87a6; border: 1px solid #cee9f9; font-size:0.8em"> {{cut_support_group_from_request_id(id_request)}} </code>
</div>

<div class="main-content" style="padding-top:0px">
  <div class="container-fluid">

    <loading-spinner *ngIf="showSpinner"></loading-spinner>
    <div *ngIf="!showSpinner"class="row">

      <div class="col-sm-7">
        <div class="card" style="padding-top:25px; padding-bottom:0px; ">

          <div #scrollMe class="card-content" style="height: 450px; overflow-y: auto;">

            <div *ngFor="let message of messagesList" style="vertical-align:baseline">
          
              <div class="row">
                <div class="col-sm-12" style="padding-right: 0px;">
                <div class="msg_sender" style="padding-right: 0px">
                  <p style="font-size: 0.9em; margin-bottom:0px">
                    <strong> {{ message.sender_fullname }} </strong> 
                  </p>
                </div>
              </div>

              <!-- <div class="msgcontainer">        
                <p style="font-size: 0.9em; margin-bottom:0px">{{ message.text }}</p>
                <span class="time-right" style="font-size: 0.8em;">
                  {{ message.timestamp | date: 'd/M/y HH:mm:ss'}}
                </span>
              </div> -->
              <div class="col-sm-10" style="margin-left: 55px;">
                <div class="talk-bubble tri-right left-in" style="margin-bottom: 12px">
                  <div class="talktext">
                    <p style="padding: 10px; margin-bottom: 0px; font-size: 0.9em; ">
                      <!-- This one adds a right triangle on the left, flush at the top by using .tri-right and .left-top to specify the location. -->
                      {{ message.text }}
                    </p>
                  
                    <span class="time-right" style="font-size: 0.8em; padding-right: 10px; padding-bottom: 5px;">
                      {{ message.timestamp | date: 'd/M/y HH:mm:ss'}}
                    </span>
                  </div>

                </div>
              </div>
            </div>
            <!-- ./ row -->
          </div>
        </div>

        <div class="card-footer" style="text-align: center;">
          <div class="stats">

            <!-- ENTER -->
            <span *ngIf="HAS_COMPLETED_JOIN_TO_GROUP_POST_REQUEST === true || IS_CURRENT_USER_JOINED === true">
                <a class="btn btn-info" role="button" right style="color: white;" 
                    target="_blank" href="{{ CHAT_BASE_URL }}?recipient={{id_request}}" 
                    style="padding:12px 16px !important;">   
                  <!-- Entra -->
                  {{ 'VisitorsPage.Enter' | translate }}
                </a>
            </span>

            <!-- JOIN BTN -->
            <span *ngIf="JOIN_TO_GROUP_HAS_ERROR === false 
                && IS_CURRENT_USER_JOINED === false 
                && SHOW_JOIN_TO_GROUP_SPINNER_PROCESSING === false 
                && HAS_COMPLETED_JOIN_TO_GROUP_POST_REQUEST === false">
              <button class="btn btn-default" (click)="onJoinHandled()" style="padding:12px 16px !important;">
                Join
              </button>
            </span>

            <!-- LOADING BTN -->
            <span *ngIf="SHOW_JOIN_TO_GROUP_SPINNER_PROCESSING === true 
                && HAS_COMPLETED_JOIN_TO_GROUP_POST_REQUEST === false  
                && JOIN_TO_GROUP_HAS_ERROR === false">
              <button class="btn btn-default" style="padding:12px 16px !important;">
                <i class="fa fa-spinner fa-spin"></i> 
                  <!-- Elaborazione -->
                  {{ 'VisitorsPage.Loading' | translate }}
               </button>
             </span>

             <!-- IF THE CALLBALL JOIN-TO-GROUP HAS ERROR SHOWS THE BTN ERROR (DISABLED)  -->
            <span *ngIf="JOIN_TO_GROUP_HAS_ERROR === true">
              <button class="btn btn-danger" disabled style="padding:12px 16px !important;">
                <!-- Errore -->
                {{ 'VisitorsPage.Error' | translate }}
              </button>
            </span>

          </div>
        </div>
      </div>  
      <!-- ./ card   -->
    </div>
    <!-- ./ col-md-8 -->
    <div class="col-sm-5">
      <div class="card" style="padding-top:5px; padding-bottom:25px;">

        <div class="card-content">
          <h4 class="card-title" style="text-transform: none; color: #566787; font-weight:600; margin-bottom: 15px">
              Request info
          </h4>

          <p style="margin-bottom: 3px"> <strong>Request Id </strong></p>
          <p style="color:#999999">  
              {{ id_request }}
          </p>

          <p style="margin-bottom: 3px"> <strong>Requester </strong></p>
          <p style="color:#999999">  
              {{ requester_fullname }}
          </p>

          <p style="margin-bottom: 3px"> <strong>Requester Id</strong></p>
          <p style="color:#999999">  
              {{ requester_id }}
          </p>

          <p style="margin-bottom: 3px"> <strong>Department Name</strong></p>
          <p style="color:#999999">  
              {{ department_name }}
          </p>

          <p style="margin-bottom: 3px"> <strong>Department Id</strong></p>
          <p style="color:#999999">  
              {{ department_id }}
          </p>

          <p style="margin-bottom: 3px"> <strong>Source page</strong></p>
          <p style="color:#999999; word-wrap: break-word;">  
              {{ source_page }}
          </p>

        </div>
      </div>

    </div>

  </div>
  <!-- ./ row -->


</div>