<div class="content columns">
  <main class="column is-10 is-offset-1">

    <h1>Firestore Requests</h1>
    <hr>
    <loading-spinner *ngIf="showSpinner"></loading-spinner>

    <!-- MOMGO DB CONTACT LIST -->
    <span *ngIf="!showSpinner">
      <table class="table is-narrow is-bordered" style="margin-top:25px">
        <thead>
          <tr>
          <th style="">
          
          </th>
          
          <th>
            Id
            <!-- Recipient -->
          </th>
          <!-- <th>
            Recipient Full Name
          </th> -->
          <th>
            Sender
          </th>
          <th>
            Message
          </th>
          <th>
            Date
          </th>
          </tr>
        </thead>
      
        <tbody>
      
          <tr *ngFor="let request of requestList">
            
            <td>
              <span *ngIf="request?.membersCount == 0"> 
                  <i style="color:red; font-size:1.5em;" class="fa fa-exclamation"></i>
              </span>
            </td>
            <td>
              {{ request?.recipient }}
            </td>
            <!-- <td>
              {{ request.recipient_fullname }}
            </td> -->
            <td>
              {{ request.sender_fullname }}
            </td>
            <td>
              {{ request?.text }}
            </td>
            <td>
              {{ request?.timestamp | date: 'd/M/y HH:mm:ss'}}
            </td>
            <td style="text-align: center!important">
              <span class="button is-small " (click)='openViewMsgsModal(request?.recipient, hasClickedUpdateModal=true)'>
                View
              </span>
            </td>
    
          </tr>
        </tbody>
      </table>
    </span>

   

  </main>
</div>

    <!-- MODAL -->
    <!-- <div class="backdrop" [ngStyle]="{'display':display}"></div> -->
    <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':display}" aria-hidden="true" style="">
        <div class="modal-dialog" role="document" style="overflow-y: initial !important;">
          <div class="modal-content">

            <div class="modal-header">
              <button type="button" class="close" aria-label="Close" (click)="onCloseModal()">
                <span aria-hidden="true">&times;</span>
              </button>
              <h4 class="modal-title">Messages for request:
                <code>{{requestRecipient}}</code>
              </h4>
            </div>
            <!-- id="scrollable" -->
            <!-- #scrollMe style="overflow: scroll; height: 250px;" -->
            <div class="modal-body" >
                <div  #scrollMe style="height: 250px; overflow-y: auto;" (scroll)="onScroll($event)">
                  <div *ngFor="let message of messagesList" style="vertical-align:baseline">
                      
                    <div class="msg_sender">
                      <p style="font-size: 0.9em">
                        <strong> {{ message.sender_fullname }} </strong> 
                      </p>
                    </div>

                    <div class="msgcontainer">        
                      <!-- <p><code>{{ message.recipient}}</code></p> -->
                      <!-- <p><strong>  {{ message.sender_fullname }} </strong></p> -->
                      <p style="font-size: 0.9em">{{ message.text }}</p>
                      <span class="time-right" style="font-size: 0.8em">
                        {{ message.timestamp | date: 'd/M/y HH:mm:ss'}}
                      </span>
                    </div>
                  
                  </div>

                </div> 

                <a id="fixed-button"  class="button" (click)="scrollToBottom()" [ngStyle]="{'display':displayBtnScrollToBottom }">
                  <span class="icon is-small">
                    <i class="fa fa-chevron-down"></i>
                  </span>
                </a>
            </div>
            <!-- ./ modal body -->
            
         
            <div class="modal-footer">
              <button type="button" class="button" (click)="onCloseModal()">Cancel</button>
              <button type="button" class="button is-success" (click)="onJoinHandled()">Join</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal !-->



