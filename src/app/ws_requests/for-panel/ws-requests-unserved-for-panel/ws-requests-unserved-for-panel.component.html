<!-- <appdashboard-navbar-for-panel></appdashboard-navbar-for-panel> -->
<!-- border-bottom: 1px solid #3f3f40; -->

<div class="selected-project-bar" *ngIf="OPEN_REQUEST_DETAILS === false">

  <div class="flex-container">
    <div class="flex-child-project-avatar" style="" (click)="goBackToProjectsList()">
      <span class="material-icons go-back-icon">
        arrow_back_ios
      </span>
    </div>

    <div class="flex-child-project-name">
      <div class="project-name-in-unserved-top-bar">
        {{ projectName }}
      </div>
    </div>
  </div>
</div>
<!-- *ngIf="OPEN_REQUEST_DETAILS === false" -->
<div class="main-content main-content-projects-for-panel" style="min-height: calc(100% - 40px);"
 >
  <div class="container-fluid container-projects-for-panel">

    <div class="row">

      <div *ngIf="showSpinner && !SHOW_NO_REQUEST_MSG" class="stretchspinner">
        <!-- <div *ngIf="showSpinner" class="stretchspinner"> -->
        <div class="rect1"></div>
        <div class="rect2"></div>
        <div class="rect3"></div>
        <div class="rect4"></div>
        <div class="rect5"></div>
      </div>


      <div *ngIf="!showSpinner && wsRequestsUnserved?.length === 0">
        <!-- <div *ngIf="!showSpinner"> -->

        <!--
        // ----------------------------------------------------------------
        // No request message
        // ---------------------------------------------------------------- -->
        <div class="no-request-msg-wrapper">
          <span class="material-icons no-request-icon">
            sms_failed
          </span>
          <span class="no-request-msg">
            {{'NoUnservedRequests' | translate}}
          </span>
        </div>
      </div>

      <div *ngIf="!showSpinner && wsRequestsUnserved?.length > 0" class="left-sidebar-unserved-requests-wrapper">
        <div class="row">
          <div class="col-xs-12">
            <h4 class="unserved-for-panel-title">
              {{wsRequestsUnserved?.length }} {{'VisitorsPage.UnservedRequests' | translate}}
            </h4>
          </div>
        </div>
        <div class="left-sidebar-unserved-requests" *ngFor="let request of wsRequestsUnserved">

          <!-- GRID ---------------------------------------------------------------- -->
          <div class="grid-container">
            <div class="lead-avatar-column" (click)="displayDetails(request)">

              <div class="lead-avatar-wrap" style="position:relative">
                <!-- [ngStyle]="{'background-color': request?.requester_fullname_fillColour }"  -->
                <div class="lead--avatar"
                  [ngStyle]="{'background':  'linear-gradient(rgb(255,255,255) -125%,' + request?.requester_fullname_fillColour + ')'}"
                  [ngClass]="{'requester_fullname-undefined' : !request?.snapshot?.lead?.fullname }">
                  <span style="color: #ffffff"> {{ request?.requester_fullname_initial }} </span>
                  <div class="requester-status-in-unserved-list"
                    [ngClass]="{'requester-is-online' : request?.REQUESTER_IS_ONLINE, 'requester-is-offline' : !request?.REQUESTER_IS_ONLINE }">
                  </div>
                </div>
              </div>
            </div>

            <div class="right-column" (click)="displayDetails(request)">
              <div class="lead-name">
                <div class="lead--name">
                  {{ request?.lead?.fullname }}
                  <!-- {{ request?.lead?.lead_id }} -->
                  <span *ngIf="!request?.lead?.fullname">
                    N/A
                  </span>
                </div>
              </div>
              <div class="time">
                <div class="request--creation-time">
                  {{ request?.createdAt | amTimeAgo }}
                </div>
              </div>
              <div class="first-msg">
                <div class="request--first-message text-truncated" [innerHTML]="request?.first_text">
                </div>
              </div>
              <div class="actions-btns">
                <div class="join-btn-col">
                  <div class="tool_tip" style="width: 100%;">
                    <button class="btn btn-block btn-primary action--btn"
                      (click)='$event.stopPropagation();joinRequest(request?.request_id)'>
                      Join
                    </button>
                    <span class="top"
                      style="min-width: fit-content; top:-8px; border-radius: 3px; padding: 3px 10px; white-space: nowrap;">
                      <span style="text-transform: capitalize;"> {{ 'RequestMsgsPage.Enter' | translate }} </span>
                      <i></i>
                    </span>
                  </div>
                </div>
                <div class="archive-btn-col">
                  <div class="tool_tip" style="width: 100%;">
                    <!-- padding: 4px 8px!important; -->
                    <button class="btn btn-block btn-primary action--btn"
                      (click)='$event.stopPropagation();archiveRequest(request?.request_id)'
                      style="background-color: #e4e6eb; color: #050505;">
                      Archive
                    </button>
                    <span
                      style="min-width: fit-content; top:-8px; border-radius: 3px; padding: 3px 10px; white-space: nowrap;"
                      class="top">
                      <span style="text-transform: capitalize;"> {{ 'VisitorsPage.Archive' | translate }} </span>
                      <i></i>
                    </span>
                  </div>
                </div>
              </div>
              <div class="arrow-container" (click)="displayDetails(request)">
                <div id="arrow_3" class="arrow-wrapper">
                  <div class="arrow arrow--right">
                    <span></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- ./ GRID ---------------------------------------------------------------- -->

        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="OPEN_REQUEST_DETAILS === true" class="view-side">
  <appdashboard-ws-request-detail-for-panel [ngStyle]="{'height':train_bot_sidebar_height }"
    (valueChange)='handleCloseRightSidebar($event)' [selectedRequest]="selectedRequest" [wsRequestsUnserved]="wsRequestsUnserved">
  </appdashboard-ws-request-detail-for-panel>
</div>