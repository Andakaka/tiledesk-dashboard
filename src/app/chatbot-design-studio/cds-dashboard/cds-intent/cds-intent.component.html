<div class="panel-intent-content tds_draggable">

    <div class="pic-header tds_draggable">
        
        <!-- <div class="pic-header-title tds_draggable">
            <div class="pic-header-title-input tds_draggable">
                <div class="pic-title-text tds_draggable">
                    {{ intent.intent_display_name }}
                </div>
            </div>
        </div> -->
        <appdashboard-panel-intent-header class="pic-title-text tds_draggable"
            [intentSelected]="intent"
            [listOfIntents]="listOfIntents">
        </appdashboard-panel-intent-header>

    </div>


    <div class="drag-actions target-container"
        [cdkDropListData]="listOfActions"
        cdkDropList
        (cdkDropListDropped)="onDropAction($event)">
         <!-- [id]="'action_'+i" -->
        <div *ngFor="let action of listOfActions; let i = index, let last = last;"
            cdkDrag
            (cdkDragStarted)="onDragStarted($event, intent.intent_id)"
            (cdkDragReleased)="onDragEnded($event)"
            [id]="action._tdActionId"
            class="box-action"
            tabindex="0"
            [ngClass]="{
            'cds-action-active': intentService.actionSelectedID === action._tdActionId, 
            'cds-no-featured-action': action._tdActionType !== TYPE_ACTION.REPLY}"
            (keydown)="onKeydown($event)">
            <!-- (click)="onActionSelected(action, i, action._tdActionId)" -->
            <!-- (keydown)="onDeleteAction($event)" -->
            
            <!-- <div cdkDragHandle class="header-action"> -->
                <!-- <div class="icon-action">
                    <img [src]="getActionParams(action).src" [title]="getActionParams(action).name" />
                </div>
                <span class="label-action">
                    <div class="sc-irCEUn gzQaYi vf-canvas__step-item-label">
                        {{ getActionParams(action).name }}
                    </div>
                </span> -->
            <cds-action-description cdkDragHandle class="header-action"
                [elementType]="action._tdActionType">
            </cds-action-description>

            <!-- </div> -->

            
            <div cdkDragDisabled class="body-action" [ngSwitch]="action._tdActionType">

                <cds-action-controls
                    (onClickControl)="onClickControl($event, action, i)">
                </cds-action-controls>


                <cds-action-reply *ngSwitchCase="TYPE_ACTION.REPLY" 
                    class="panel-response" 
                    [intentSelected]="intent"
                    [connector]="connector" 
                    [action]="action" 
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-reply>

                <cds-action-reply *ngSwitchCase="TYPE_ACTION.RANDOM_REPLY"
                    class="panel-response"
                    [intentSelected]="intent"
                    [action]="action" 
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-reply>

                <cds-action-intent *ngSwitchCase="TYPE_ACTION.INTENT"
                    class="panel-response"
                    [intentSelected]="intent"
                    [action]="action" 
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-intent>

                <cds-action-change-department *ngSwitchCase="TYPE_ACTION.CHANGE_DEPARTMENT" 
                    class="panel-response"
                    [action]="action"
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-change-department>

                <cds-action-email *ngSwitchCase="TYPE_ACTION.EMAIL" 
                    class="panel-response" 
                    [action]="action" 
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-email>

                <cds-action-agent *ngSwitchCase="TYPE_ACTION.AGENT" 
                    class="panel-response"
                    [action]="action" 
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-agent>

                <cds-action-online-agents *ngSwitchCase="TYPE_ACTION.ONLINE_AGENTS"
                    class="panel-response"
                    [connectorChanged]="connectorChanged"    
                    [intentSelected]="intent"
                    [action]="action"
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-online-agents>

                <cds-action-open-hours *ngSwitchCase="TYPE_ACTION.OPEN_HOURS"
                    class="panel-response"
                    [connectorChanged]="connectorChanged"    
                    [intentSelected]="intent"
                    [action]="action"
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-open-hours>

                <cds-action-wait *ngSwitchCase="TYPE_ACTION.WAIT" 
                    class="panel-response"
                    [action]="action" 
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-wait>

                <cds-action-close *ngSwitchCase="TYPE_ACTION.CLOSE"
                    [action]="action">
                </cds-action-close>

                <cds-action-json-condition *ngSwitchCase="TYPE_ACTION.JSON_CONDITION"
                    class="panel-response"
                    [intentSelected]="intent"
                    [action]="action"
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-json-condition>

                <cds-action-replace-bot *ngSwitchCase="TYPE_ACTION.REPLACE_BOT" 
                    class="panel-response"
                    [action]="action" 
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-replace-bot>

                <cds-action-assign-variable *ngSwitchCase="TYPE_ACTION.ASSIGN_VARIABLE"
                    class="panel-response"
                    [action]="action"
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-assign-variable>

                <cds-action-delete-variable *ngSwitchCase="TYPE_ACTION.DELETE_VARIABLE"
                    class="panel-response"
                    [action]="elementSelected">
                </cds-action-delete-variable>
                
                <cds-action-hide-message *ngSwitchCase="TYPE_ACTION.HIDE_MESSAGE"
                    class="panel-response"   
                    [action]="action"
                    (updateAndSaveAction)="onUpdateAndSaveAction($event)">
                </cds-action-hide-message>


            </div>

            <cds-action-arrow *ngIf="!last"></cds-action-arrow>

        </div>

        <div class="csd-add-action-btn-wpr csd-add-action-btn-wpr-element">
            <button #openActionMenuBtn (click)="openActionMenu(intent)" class="btn cds-add-action-btn csd-add-action-btn-wpr-element">
                <span class="material-icons csd-add-action-btn-wpr-element">
                    add
                </span>
            </button>
        </div>

  
    </div>


</div>