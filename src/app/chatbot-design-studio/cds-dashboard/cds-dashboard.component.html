<cds-header class="cds-header"
    [IS_OPEN]="IS_OPEN"
    [projectID]="projectID"
    [id_faq_kb]="id_faq_kb"
    [defaultDepartmentId]=""
    [selectedChatbot]="selectedChatbot"
    (goToBck)="goBack()"
    (toggleSidebarWith)="onToggleSidebarWith($event)"> 
</cds-header>

<div class="chatboat-dashboard">

    <cds-sidebar 
        class="cds-sidebar"
        [class.is_opened]="IS_OPEN"
        [extendedWidth]="IS_OPEN" 
        [projectID]="projectID" 
        (onClickItemList)="onClickItemList($event)"
        (goToBck)="goBack()">
    </cds-sidebar>

    <div class="cds-content">
        <ng-container [ngSwitch]="activeSidebarSection">
            <ng-container *ngSwitchCase="'cds-sb-settings'" [ngTemplateOutlet]="settings"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-fulfillment'" [ngTemplateOutlet]="fulfillment"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-training'" [ngTemplateOutlet]="training"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-rules'" [ngTemplateOutlet]="rules"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-intents'" [ngTemplateOutlet]="intents"></ng-container>
            <ng-container *ngSwitchDefault [ngTemplateOutlet]="intents"></ng-container>
        </ng-container>
    </div>


    <ng-template #settings>
        <cds-chatbot-details [selectedChatbot]="selectedChatbot"></cds-chatbot-details>
    </ng-template>

    <ng-template #fulfillment>
        <cds-fulfillment [chatbot]="selectedChatbot"></cds-fulfillment>
    </ng-template>

    <ng-template #training>
        ... choice training...
    </ng-template>

    <ng-template #rules>
        <cds-rules [listOfIntents]="listOfIntents" [selectedChatbot]="selectedChatbot"></cds-rules>
    </ng-template>

    <ng-template #intents cdkDropListGroup>
        
        <div id="cds-box-left" class="box-left">
            <appdashboard-panel-intent-list 
                *ngIf="listOfIntents"
                class="panel-intent-list" 
                [intents] = "listOfIntents"
                [intent_id]="intent_id"
                (selectIntent)=onSelectIntent($event)
                (deleteIntent)="onDeleteIntent($event)">
            </appdashboard-panel-intent-list>
        </div>

        

        <div id="cds-box-right" class="drag-content box-right">

            <div #receiver_elements_dropped_on_stage class="receiver-elements-dropped-on-stage" cdkDropList (cdkDropListDropped)="onDroppedElementToStage($event)"></div>

            <cds-panel-elements class="cds-panel-elements"
                (showPanelActions)="onShowPanelActions($event)"
                (addNewElement)="onAddNewElement()"
            ></cds-panel-elements>

            <div #drawer_of_items_to_zoom_and_drag id="drawer-of-items-to-zoom-and-drag" class="drag-drawer box-right-content">
                
                <cds-panel-intent *ngFor="let intent of listOfIntents; let i = index; let lastIntent = last; let firstIntent = first"
                        [id]="intent.id"
                        [style.top.px]="getIntentPosition(intent.id).y" 
                        [style.left.px]="getIntentPosition(intent.id).x" 
                        draggable="true"
                        class="panel-intent draggable prevent-select input-block"
                        [idSelected]="idElementOfIntentSelected"
                        [intentSelected]="intent"
                        [isIntentElementSelected]="isIntentElementSelected"
                        [isOpenActionDrawer]="isOpenActionDrawer"
                        [eventUpadatedIntent]="upadatedIntent.asObservable()"
                        [eventCreateIntent]="createIntent.asObservable()" 
                        (openActionDrawer)=onOpenActionDrawer($event)
                        (answerSelected)=onAnswerSelected($event) 
                        (actionSelected)=onActionSelected($event)
                        (questionSelected)=onQuestionSelected($event) 
                        (actionDeleted)=onActionDeleted($event)
                        (intentForm)=onIntentFormSelected($event)
                        (dropAction)=onDropAction($event)>
                </cds-panel-intent>
  

                <!-- <appdashboard-panel-actions *ngIf="isOpenActionDrawer" 
                    style="z-index: 101;" 
                    [intentSelected]="intentSelected"
                    (addNewAction)=onAddNewAction($event)
                    (openActionDrawer)=onOpenActionDrawer($event)>
                </appdashboard-panel-actions>
      
                <appdashboard-panel-intent-detail *ngIf=isIntentElementSelected
                    class="panel-intent-detail-wrapper"
                    (click)="onClickPanelIntentDetail()"
                    [class.sidebar-opened]="IS_OPEN"
                    [listOfActions]="listOfActions" 
                    [elementIntentSelected]="elementIntentSelected"
                    [intentSelected]="intentSelected" 
                    [showSpinner]="showSpinner"
                    (closeAndSavePanelIntentDetail)="onCloseAndSavePanelIntentDetail($event)"
                    (clickedInsidePanelIntentDetail)="onClickedInsidePanelIntentDetail()">
                </appdashboard-panel-intent-detail> -->

                <!-- <cds-footer class="cds--footer" 
                    *ngIf=intentSelected 
                    [intentSelected]="intentSelected"
                    (saveIntent)=onSaveIntent($event) 
                    [listOfIntents]="listOfIntents"
                    [newIntentName]="newIntentName">
                </cds-footer> -->
            </div>

            

        </div>

        <cds-panel-detail
            [isOpenPanelDetail] ="isOpenPanelDetail"
        ></cds-panel-detail> 

    </ng-template>

</div>





<cds-modal-activate-bot
    [selectedChatbot]="selectedChatbot">
</cds-modal-activate-bot>

<cds-popup></cds-popup>