<!-- (goToGetBotById)="getBotById($event)" -->
<cds-header class="cds-header"
    [IS_OPEN]="IS_OPEN"
    [projectID]="projectID"
    [id_faq_kb]="id_faq_kb"
    [defaultDepartmentId]=""
    [selectedChatbot]="selectedChatbot"
    (goToBck)="goBack()"
    (toggleSidebarWith)="onToggleSidebarWith($event)"> 
</cds-header>

<div class="chatboat-dashboard"  cdkDropListGroup>

    <cds-sidebar 
        class="cds-sidebar"
        [class.is_opened]="IS_OPEN"
        [extendedWidth]="IS_OPEN" 
        [projectID]="projectID" 
        (onClickItemList)="onClickItemList($event)"
        (goToBck)="goBack()">
    </cds-sidebar>

    <div class="cds-content">
        <ng-container [ngSwitch]="activeSidebarSection">
            <ng-container *ngSwitchCase="'cds-sb-settings'" [ngTemplateOutlet]="settings"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-fulfillment'" [ngTemplateOutlet]="fulfillment"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-training'" [ngTemplateOutlet]="training"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-rules'" [ngTemplateOutlet]="rules"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-intents'" [ngTemplateOutlet]="intents"></ng-container>
            <ng-container *ngSwitchDefault [ngTemplateOutlet]="intents"></ng-container>
        </ng-container>
    </div>


    <ng-template #settings>
        <cds-chatbot-details [selectedChatbot]="selectedChatbot"></cds-chatbot-details>
    </ng-template>

    <ng-template #fulfillment>
        <cds-fulfillment [chatbot]="selectedChatbot"></cds-fulfillment>
    </ng-template>

    <ng-template #training>
        ... choice training...
    </ng-template>

    <ng-template #rules>
        <cds-rules [listOfIntents]="listOfIntents" [selectedChatbot]="selectedChatbot"></cds-rules>
    </ng-template>


    <ng-template #intents>
        
        <div id="cds-box-left" class="box-left">
            <appdashboard-panel-intent-list 
                *ngIf="listOfIntents"
                class="panel-intent-list" 
                [intents] = "listOfIntents"
                [intent_id]="intent_id"
                (selectIntent)=onSelectIntent($event)
                (deleteIntent)="onDeleteIntent($event)">
            </appdashboard-panel-intent-list>
        </div>

        <div id="cds-box-right" class="drag-content box-right">

            <cds-panel-elements class="cds-panel-elements"
                (showPanelActions)="onShowPanelActions($event)"
                (addNewElement)="onAddNewElement()"
            ></cds-panel-elements>

            <!-- <cds-panel-actions class="cds-panel-actions"
                [pos]="positionPanelActions"
                [isOpenPanelActions] ="isOpenPanelActions"
            ></cds-panel-actions>  -->

            <!-- <cds-splash-screen *ngIf=!intentSelected 
                [text]="'Select a block from the left sidebar or create a new one'"
                [videoUrl]="'https://www.youtube.com/embed/b0laljUl85E'"
                [videoDescription]="'Learn about conversation blocks and how to create them here'"
                [section]="'cds-sb-intents'" 
                (onClickBtn)="onAddIntentFromSplashScreen($event)">
            </cds-splash-screen> -->

            <!-- <div class="box-right-header">
                <appdashboard-panel-intent-header *ngIf=intentSelected 
                    [intentSelected]="intentSelected"
                    [listOfIntents]="listOfIntents" 
                    (saveIntent)=onSaveIntent($event)>
                </appdashboard-panel-intent-header>
            </div> -->

            <div id="cds-box-right-content" class="drag-drawer box-right-content">
                
                <!-- <div *ngFor="let intent of listOfIntents; let i = index;let lastIntent = last; let firstIntent = first"> -->
                    <!-- <div [id]="intent.id" class="draggable prevent-select input-block">
                        <p>Move2</p>
                    </div> 
                   [ngStyle]="{'top.px':intent.attribute.y ? intent.attribute.y : '0px' }"-->
                    
                    <cds-panel-intent *ngFor="let intent of listOfIntents; let i = index;let lastIntent = last; let firstIntent = first"
                        [id]="intent.id"
                        [style.top.px]="(intent.attributes && intent.attributes.y)?intent.attributes.y:0" 
                        [style.left.px]="(intent.attributes && intent.attributes.x)?intent.attributes.x:0"
                        draggable="true"
                        class="panel-intent draggable prevent-select input-block"
                        [idSelected]="idElementOfIntentSelected"
                        [intentSelected]="intent"
                        [isIntentElementSelected]="isIntentElementSelected"
                        [isOpenActionDrawer]="isOpenActionDrawer"
                        [eventUpadatedIntent]="upadatedIntent.asObservable()"
                        [eventCreateIntent]="createIntent.asObservable()" 
                        (openActionDrawer)=onOpenActionDrawer($event)
                        (answerSelected)=onAnswerSelected($event) 
                        (actionSelected)=onActionSelected($event)
                        (questionSelected)=onQuestionSelected($event) 
                        (actionDeleted)=onActionDeleted($event)
                        (intentForm)=onIntentFormSelected($event)
                        (dropAction)=onDropAction($event)>
                    </cds-panel-intent>
                <!-- </div> -->

                <!-- <appdashboard-panel-actions *ngIf="isOpenActionDrawer" 
                    style="z-index: 101;" 
                    [intentSelected]="intentSelected"
                    (addNewAction)=onAddNewAction($event)
                    (openActionDrawer)=onOpenActionDrawer($event)>
                </appdashboard-panel-actions>
      
                <appdashboard-panel-intent-detail *ngIf=isIntentElementSelected
                    class="panel-intent-detail-wrapper"
                    (click)="onClickPanelIntentDetail()"
                    [class.sidebar-opened]="IS_OPEN"
                    [listOfActions]="listOfActions" 
                    [elementIntentSelected]="elementIntentSelected"
                    [intentSelected]="intentSelected" 
                    [showSpinner]="showSpinner"
                    (closeAndSavePanelIntentDetail)="onCloseAndSavePanelIntentDetail($event)"
                    (clickedInsidePanelIntentDetail)="onClickedInsidePanelIntentDetail()">
                </appdashboard-panel-intent-detail> -->

                <!-- <cds-footer class="cds--footer" 
                    *ngIf=intentSelected 
                    [intentSelected]="intentSelected"
                    (saveIntent)=onSaveIntent($event) 
                    [listOfIntents]="listOfIntents"
                    [newIntentName]="newIntentName">
                </cds-footer> -->
            </div>

        </div>
    </ng-template>

    <cds-panel-detail
        [isOpenPanelDetail] ="isOpenPanelDetail"
    ></cds-panel-detail> 

</div>





<cds-modal-activate-bot
    [selectedChatbot]="selectedChatbot">
</cds-modal-activate-bot>

<cds-popup></cds-popup>