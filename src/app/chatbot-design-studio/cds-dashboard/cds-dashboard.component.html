<cds-header class="cds-header"
    [IS_OPEN]="IS_OPEN"
    [projectID]="projectID"
    [id_faq_kb]="id_faq_kb"
    [defaultDepartmentId]=""
    [selectedChatbot]="selectedChatbot"
    (goToBck)="goBack()"
    (toggleSidebarWith)="onToggleSidebarWith($event)"> 
</cds-header>

<div class="chatboat-dashboard">

    <cds-sidebar 
        class="cds-sidebar"
        [class.is_opened]="IS_OPEN"
        [extendedWidth]="IS_OPEN" 
        [projectID]="projectID" 
        (onClickItemList)="onClickItemList($event)"
        (goToBck)="goBack()">
    </cds-sidebar>

    <div class="cds-content">
        <ng-container [ngSwitch]="activeSidebarSection">
            <ng-container *ngSwitchCase="'cds-sb-settings'" [ngTemplateOutlet]="settings"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-fulfillment'" [ngTemplateOutlet]="fulfillment"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-training'" [ngTemplateOutlet]="training"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-rules'" [ngTemplateOutlet]="rules"></ng-container>
            <ng-container *ngSwitchCase="'cds-sb-intents'" [ngTemplateOutlet]="intents"></ng-container>
            <ng-container *ngSwitchDefault [ngTemplateOutlet]="intents"></ng-container>
        </ng-container>
    </div>

    <ng-template #settings>
        <cds-chatbot-details [selectedChatbot]="selectedChatbot"></cds-chatbot-details>
    </ng-template>

    <ng-template #fulfillment>
        <cds-fulfillment [chatbot]="selectedChatbot"></cds-fulfillment>
    </ng-template>

    <ng-template #training>
        ... choice training...
    </ng-template>

    <ng-template #rules>
        <cds-rules [listOfIntents]="listOfIntents" [selectedChatbot]="selectedChatbot"></cds-rules>
    </ng-template>

    <ng-template #intents cdkDropListGroup>
        
        <div class="box-left">
            <cds-panel-intent-list 
                *ngIf="listOfIntents"
                class="panel-intent-list" 
                [updatePanelIntentList] = "updatePanelIntentList"
                [listOfIntents] = "listOfIntents"
                [intent_id]="intent_id"
                (selectIntent)=onSelectIntent($event)
                (deleteIntent)="onDeleteIntent($event)"
            ></cds-panel-intent-list>
        </div>

        <div id="tds_container" class="tds-drag-container box-right">

            <div #receiver_elements_dropped_on_stage class="receiver-elements-dropped-on-stage" cdkDropList (cdkDropListDropped)="onDroppedElementToStage($event)"></div>

            <cds-panel-elements 
                class="cds-panel-elements"
                (showPanelActions)="onShowPanelActions($event)"
                (addNewElement)="onAddNewElement()"
            ></cds-panel-elements>

            <div #drawer_of_items_to_zoom_and_drag id="tds_drawer" class="tds-drag-drawer2 box-right-content2">
         
                <cds-panel-intent *ngFor="let intent of listOfIntents;"
                    [id]="intent.id"
                    class="panel-intent tds_input_block tds_draggable" 
                    [style.top.px]="getIntentPosition(intent.id).y" 
                    [style.left.px]="getIntentPosition(intent.id).x" 
                    [intent]="intent"
                    [connector]="connector"
                    (selectAction)=onSelectAction($event)
                    (saveIntent)=onSaveIntent($event)
                ></cds-panel-intent>
                <!-- 
                [listOfActions]="listOfActions"
                [idSelected]="idElementOfIntentSelected"
                [isIntentElementSelected]="isIntentElementSelected"
                [isOpenActionDrawer]="isOpenActionDrawer"
                [eventUpadatedIntent]="upadatedIntent.asObservable()"
                [eventCreateIntent]="createIntent.asObservable()" 
                (openActionDrawer)=onOpenActionDrawer($event)
                (answerSelected)=onAnswerSelected($event) 
                (actionSelected)=onActionSelected($event)
                (questionSelected)=onQuestionSelected($event) 
                (actionDeleted)=onActionDeleted($event)
                (intentForm)=onIntentFormSelected($event) -->

                <svg id="svgContainer" class="tds_path" style="overflow: visible;left: 0px;top: 0px;position: absolute; z-index:-1"
                    xmlns="http://www.w3.org/2000/svg">
                    <g id="svgConnectors" fill="white" stroke="black" stroke-width="2">
                    </g>
                </svg>
                
                
            </div>

        </div>

        <cds-panel-detail
            [isOpenPanelDetail] ="isOpenPanelDetail"
        ></cds-panel-detail> 

    </ng-template>

</div>





<cds-modal-activate-bot
    [selectedChatbot]="selectedChatbot"
></cds-modal-activate-bot>

<cds-popup></cds-popup>