<!-- NEW FOR THIS TEMPLATE -->
<div class="navbar-brand" style="z-index: -1;margin-top:10px; padding-left:30px">
    <i class="material-icons" style="vertical-align: middle !important; cursor: pointer;" (click)="goBackToDeptsList()">keyboard_arrow_left</i>
    <span *ngIf="CREATE_VIEW">
      <!-- Aggiungi Dipartimento -->
      {{ "DeptsAddEditPage.AddDept" | translate}}
    </span>
    <span *ngIf="EDIT_VIEW">
      <!-- Modifica Dipartimento -->
      {{ "DeptsAddEditPage.EditDept" | translate}}
    </span>
  </div>
  
  <div class="main-content" style="padding-top:0px">
    <div class="container-fluid">

    <div class="row">
      <div class="col-md-8">
        <div class="card" style="padding-top:25px; padding-bottom:25px">
          <div class="card-content">
  
            <span *ngIf="CREATE_VIEW">
    
              <!-- <loading-spinner *ngIf="showSpinner"></loading-spinner> -->
              
              <label style="height: 36px; padding-top: 0px; padding-left: 16px; padding-right: 16px; text-align: right;" class="col-sm-2">
                <!-- Nome Dipartimento -->
                {{ "DeptsAddEditPage.DeptName" | translate}}
              </label>
              <div class="col-sm-10">
                <input [(ngModel)]="dept_name" class="" type="text" placeholder='{{ "DeptsAddEditPage.DeptName" | translate}}' style="margin-top: 2px">
              </div>

              <!-- SPACER -->
              <!-- <div class="col-sm-12" style="height:10px"></div> -->

              <!-- RADIO BUTTON -->
              <!-- checked="true" -->

              <div class="col-sm-10 col-sm-offset-2" style="padding-left:30px; padding-top:15px">
                
                <!--     ASSIGNED (CREATE VIEW)     -->
                <div class="row">
                  <div class="col-sm-2 col-md-3" style="height: 36px;">
                    <div class="form-check" style="padding-top: 8px;">
                      <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios3" value="option3" checked
                      (click)="has_clicked_assigned(show_group_option_form = 'true', show_option_form = 'false', routing = 'assigned')">
                      
                      <label class="form-check-label" for="exampleRadios3" style="padding-left: 5px;">
                        Assigned
                      </label>
                    </div>
                  </div>
                  
                  <!-- // NEW - START SELECT GROUP FOR ROUTING ASSIGNED -->
                  <span *ngIf="dept_routing === 'assigned'">
                    <span *ngIf="SHOW_GROUP_OPTION_FORM !== 'false'"> 
                      <div class="col-sm-10 col-md-9">
                        <select #selectElem (change)="setSelectedGroup(selectElem.value)" style="min-width: 150px;" [ngClass]="{'errorGroup' : GROUP_ID_NOT_EXIST}">

                          <!-- // IF THE GROUP ASSIGNED TO THE DEFAULT DEPT HAS BEEN DELETED, IT IS DISPLAYED: 'THE GROUP DOES NOT EXIST' -->
                          <option style="color: #ff5252 !important;" *ngIf="GROUP_ID_NOT_EXIST" [selected]="GROUP_ID_NOT_EXIST">
                            <p>{{ "DeptsAddEditPage.ErrorGroupId" | translate}} {{ selectedGroupId }} {{ "DeptsAddEditPage.Trashed" | translate}} </p>
                          </option>
                          
                          <option class="not_selected" value="ALL_USERS_SELECTED">
                            <!-- All users -->
                            {{ "RoutingPage.AllUsers" | translate  }}                          
                          </option>
                    
        
                          <option  *ngFor="let group of groupsList" [value]="group?._id" [selected]="selectedGroupId === group?._id">
                            {{group?.name}}
                          </option>
                        </select>
                      </div>
                    </span>
                  </span> 
                </div>

                <!--     POOLED (CREATE VIEW)     -->
                <div class="row">
                  <div class="col-sm-2 col-md-3" style="height: 36px;">
                    <div class="form-check" style="padding-top:8px;">
                      <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="option2" 
                      (click)="has_clicked_pooled(show_group_option_form = 'true', show_option_form = 'false', routing = 'pooled')">

                      <label class="form-check-label" for="exampleRadios2" style="padding-left: 5px;">
                        Pooled
                      </label>
                    </div>
                  </div>

                  <!-- // NEW - START SELECT GROUP FOR ROUTING POOLED -->
                  <span *ngIf="dept_routing === 'pooled'">
                    <span *ngIf="SHOW_GROUP_OPTION_FORM !== 'false'"> 
                      <div class="col-sm-10 col-md-9">
                        <select #selectElem (change)="setSelectedGroup(selectElem.value)" style="min-width: 150px;" [ngClass]="{'errorGroup' : GROUP_ID_NOT_EXIST}">
                          
                          <!-- // IF THE GROUP ASSIGNED TO THE DEFAULT DEPT HAS BEEN DELETED, IT IS DISPLAYED: 'THE GROUP DOES NOT EXIST' -->
                          <option style="color: #ff5252 !important;" *ngIf="GROUP_ID_NOT_EXIST" [selected]="GROUP_ID_NOT_EXIST">
                            <p>{{ "DeptsAddEditPage.ErrorGroupId" | translate}} {{ selectedGroupId }} {{ "DeptsAddEditPage.Trashed" | translate}}</p>
                          </option>

                          <option class="not_selected" value="ALL_USERS_SELECTED">
                            {{ "RoutingPage.AllUsers" | translate  }}
                          </option>

                          <option  *ngFor="let group of groupsList" [value]="group._id" [selected]="selectedGroupId === group._id">
                            {{group.name}}
                          </option>

                        </select>
                      </div>
                    </span>
                  </span>                                 

                </div>


                <!--    BOT (IT'S ACTUALLY FAQ-KB) (CREATE VIEW)     -->
                <div class="row">
                  <div class="col-sm-2 col-md-3" style="height: 36px;">  
                    <div class="form-check" style="padding-top:8px; padding-bottom:8px">
                      <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="option1"  
                      (click)="has_clicked_fixed(show_option_form = 'true', routing = 'fixed')">

                      <label class="form-check-label" for="exampleRadios1" style="padding-left: 5px;">
                        <!-- Fixed -->
                        Bot
                      </label>
                    </div>
                  </div>

                
                  <!-- CREATE VIEW - SELECT BOT -->
                  <span *ngIf="SHOW_OPTION_FORM === 'true'">

                    <div class="col-sm-10 col-md-9" style="padding-top:0px">
                      <select #selectElem (change)="setSelectedBot(selectElem.value)" class="" >
                        <option class="not_selected" value="BOT_NOT_SELECTED">{{ "DeptsAddEditPage.SelectABot" | translate}}</option> 
                        <!-- NOTE: botsList IT'S ACTUALLY THE FAQ-KB LIST -->
                        <option  *ngFor="let bot of botsList" [value]="bot._id" [selected]="selectedId === bot._id">
                          {{ bot.name }}
                        </option>
                      </select>
    
                      <a style="margin-left: 8px; color: #03a5e8; cursor:pointer" (click)="goTo_BotEditAddPage_CREATE()"> 
                        <!-- o Crea un nuovo Bot  -->
                        {{ "DeptsAddEditPage.orCreateABot" | translate}}
                      </a>
                    </div>
                  </span>
                </div>

              </div>
                


              <!-- SPACER -->
              <div class="col-sm-12" style="height:7px"></div>

              <!-- // BUTTONS -->
              <label style="" class="col-sm-2"></label>
              <div class="col-sm-10">
                  <!-- [disabled]="bot_fullname?.length < 2 || FAQKB_NOT_SELECTED === true" -->

                <!-- ======== SWITCH THE BUTTON 'CREATE DEPT' ========
                     ACCORDING TO THE VALUE OF SHOW_OPTION_FOR 
                     IT IS 'TRUE' IT MEANS THAT THE USER HAS SELECTED 'FIXED' SO THE BTN IS DISABLED 
                     IF THE LENGHT OF DEPT IS < 2 AND IF IS NOT SELECTED ANY BOT  -->
                <span *ngIf="SHOW_OPTION_FORM === 'true'">
                  <button class="btn btn-success" [disabled]="dept_name?.length < 2 || BOT_NOT_SELECTED === true"  (click)="createDepartment()">
                    <!-- Crea Dipartimento -->
                    {{ "DeptsAddEditPage.CreateDept" | translate}}
                  </button>
                </span>
                <span *ngIf="SHOW_OPTION_FORM !== 'true'">
                  <button class="btn btn-success" [disabled]="dept_name?.length < 2"  (click)="createDepartment()">
                    <!-- Crea Dipartimento -->
                    {{ "DeptsAddEditPage.CreateDept" | translate}}
                  </button>
                </span>
              </div>

            </span>

            <!-- EDIT_VIEW -->
            <span *ngIf="EDIT_VIEW">
  
                <!-- <loading-spinner *ngIf="showSpinner"></loading-spinner> -->
  
                <label style="height: 36px; padding-top: 0px; padding-left: 16px; padding-right: 16px; text-align: right;" class="col-sm-2 ">
                  <!-- Nome Dipartmento -->
                  {{ "DeptsAddEditPage.DeptName" | translate}}
                  
                </label>
                <div class="col-sm-10">
                  <input [(ngModel)]="deptName_toUpdate" class="input" type="text" style="margin-top: 2px">
                </div>
        
                <!-- SPACER -->
                <!-- <div class="col-sm-12" style="height:10px"></div> -->

                <div class="col-sm-10 col-sm-offset-2" style="padding-left:30px; padding-top:15px">

                  <!--     ASSIGNED (EDIT_VIEW)     -->
                  <div class="row">
                    <div class="col-sm-2 col-md-3" style="height: 36px;">
                      <div class="form-check" style="padding-top: 8px;">
                        <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios3" value="option3"
                        (click)="has_clicked_assigned(show_group_option_form = 'true', show_option_form = 'false', routing = 'assigned')" [checked]="dept_routing === 'assigned'">
                        
                        <label class="form-check-label" for="exampleRadios3" style="padding-left: 5px;">
                          Assigned
                        </label>
                      </div>
                    </div>

                    <!-- // NEW - START SELECT GROUP FOR ROUTING ASSIGNED -->
                    <span *ngIf="dept_routing === 'assigned'">
                      <span *ngIf="SHOW_GROUP_OPTION_FORM !== 'false'"> 
                        <div class="col-sm-10 col-md-9">
                          <select #selectElem (change)="setSelectedGroup(selectElem.value)" style="min-width: 150px;" [ngClass]="{'errorGroup' : GROUP_ID_NOT_EXIST}">
  
                            <!-- // IF THE GROUP ASSIGNED TO THE DEFAULT DEPT HAS BEEN DELETED, IT IS DISPLAYED: 'THE GROUP DOES NOT EXIST' -->
                            <option style="color: #ff5252 !important;" *ngIf="GROUP_ID_NOT_EXIST" [selected]="GROUP_ID_NOT_EXIST">
                              <p>{{ "DeptsAddEditPage.ErrorGroupId" | translate}} {{ selectedGroupId }} {{ "DeptsAddEditPage.Trashed" | translate}}</p>
                            </option>
                            
                            <option class="not_selected" value="ALL_USERS_SELECTED">
                              <!-- All users -->
                              {{ "RoutingPage.AllUsers" | translate  }}                          
                            </option>
                      
          
                            <option  *ngFor="let group of groupsList" [value]="group?._id" [selected]="selectedGroupId === group?._id">
                              {{group?.name}}
                            </option>
                          </select>
                        </div>
                      </span>
                    </span> 

                  </div>

                  <!--     POOLED (EDIT_VIEW)      -->
                  <div class="row">
                    <div class="col-sm-2 col-md-3" style="height: 36px;">
                      <div class="form-check" style="padding-top:8px;">
                        <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="option2" 
                        (click)="has_clicked_pooled(show_group_option_form = 'true', show_option_form = 'false', routing = 'pooled')" [checked]="dept_routing === 'pooled'">

                        <label class="form-check-label" for="exampleRadios2" style="padding-left: 5px;">
                          Pooled
                        </label>
                      </div>
                    </div>

                    <!-- // NEW - START SELECT GROUP FOR ROUTING POOLED -->
                    <span *ngIf="dept_routing === 'pooled'">
                      <span *ngIf="SHOW_GROUP_OPTION_FORM !== 'false'"> 
                        <div class="col-sm-10 col-md-9">
                          <select #selectElem (change)="setSelectedGroup(selectElem.value)" style="min-width: 150px;" [ngClass]="{'errorGroup' : GROUP_ID_NOT_EXIST}">
                            
                            <!-- // IF THE GROUP ASSIGNED TO THE DEFAULT DEPT HAS BEEN DELETED, IT IS DISPLAYED: 'THE GROUP DOES NOT EXIST' -->
                            <option style="color: #ff5252 !important;" *ngIf="GROUP_ID_NOT_EXIST" [selected]="GROUP_ID_NOT_EXIST">
                              <p>{{ "DeptsAddEditPage.ErrorGroupId" | translate}} {{ selectedGroupId }} {{ "DeptsAddEditPage.Trashed" | translate}}</p>
                            </option>

                            <option class="not_selected" value="ALL_USERS_SELECTED">
                              {{ "RoutingPage.AllUsers" | translate  }}
                            </option>

                            <option  *ngFor="let group of groupsList" [value]="group._id" [selected]="selectedGroupId === group._id">
                              {{group.name}}
                            </option>

                          </select>
                        </div>
                      </span>
                    </span> 

                  </div>

                  <!--     BOT (IT'S ACTUALLY FAQ-KB)  (EDIT_VIEW)     -->
                  <div class="row">
                    <div class="col-sm-2 col-md-3" style="height: 36px;">
                      <div class="form-check" style="padding-top:8px; padding-bottom:8px; ">
                          <!-- checked="true" -->
                        <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="option1" 
                        (click)="has_clicked_fixed(show_option_form = 'true', routing = 'fixed')" [checked]="dept_routing === 'fixed'">

                        <label class="form-check-label" for="exampleRadios1" style="padding-left: 5px;">
                          <!-- Fixed -->
                          Bot
                        </label>
                      </div>
                    </div>
 
                    <span *ngIf="dept_routing === 'fixed'">  
                      <span *ngIf=" SHOW_OPTION_FORM !== 'false'">
                      
                        <div class="col-sm-10 col-md-9" style="padding-top:0px">  
                          <select #selectElem (change)="setSelectedBot(selectElem.value)"  >
                          
                            <option class="not_selected" value="BOT_NOT_SELECTED" >{{ "DeptsAddEditPage.SelectABot" | translate }}</option>
                              <!-- NOTE: botsList IT'S ACTUALLY THE FAQ-KB LIST -->
                            <option  *ngFor="let bot of botsList" [value]="bot._id" [selected]="selectedId === bot._id">
                              
                              {{bot.name}}
                              
                            </option>
                          </select>

                          <a style="margin-left: 8px; color: #03a5e8; cursor:pointer" (click)="goTo_BotEditAddPage_CREATE()"> 
                            <!-- o Crea un nuovo Bot  -->
                            {{ "DeptsAddEditPage.orCreateABot" | translate }}

                          </a>
                        </div>
                      </span>
                    </span>
                  </div>
                
                </div>
  
                <!-- SPACER -->
                <div class="col-sm-12" style="height:7px"></div>
                
                <label class="col-sm-2"></label>
                <div class="col-sm-10"> 
                  <!-- <span *ngIf="dept_routing !== 'pooled'"> -->
                  <!-- <span *ngIf=" SHOW_OPTION_FORM !== 'false'"> -->
                  <span *ngIf="dept_routing === 'fixed'">    
                    <button class="btn btn-success" (click)="edit()" [disabled]="BOT_NOT_SELECTED === true">
                      <!-- Modifica Dipartimento -->
                      {{ "DeptsAddEditPage.UpdateDept" | translate }}
                    </button>
                  </span>
                  <!-- </span> -->
                  <!-- [disabled]="BOT_NOT_SELECTED === true" -->
                  <!-- <span *ngIf=" SHOW_OPTION_FORM === 'false'"> -->
                  <span *ngIf="dept_routing === 'assigned' || dept_routing === 'pooled'">  
                    <button class="btn btn-success" (click)="edit()" [disabled]='GROUP_ID_NOT_EXIST'>
                      <!-- Modifica Dipartimento -->
                      {{ "DeptsAddEditPage.UpdateDept" | translate }}
                    </button>
                  </span>
                </div>
              </span>
              <!-- /. EDIT_VIEW -->

          </div>
        </div>
      </div>
      <!-- /. col-md-8 -->
      
      <!-- RIGHT SIDEBAR -->
      <div class="col-md-4">
        <div class="card">
          <div class="card-content" style="padding-top: 25px; ">
            <h4 class="card-title" style="text-transform: none; color: #566787; font-weight:600; margin-bottom: 15px">
              Quick tips
            </h4>

            <p style="margin-bottom: 3px"> <strong>Assigned </strong></p>
            <p style="color:#999999">
                
                Assigned chats help maintain an even workload distribution, especially for larger teams. Chat limits keep agents from getting overwhelmed by chats, especially during high traffic. Experienced agents can help clear the queue faster with the Hybrid Assignment Mode. Enable Reassignments and Automatic Idle to reduce visitor wait time by preventing chats from getting assigned to inactive agents.
            </p>

            <p style="margin-bottom: 3px"> <strong>Pooled </strong></p>
            <p style="color:#999999">
                
                Pooled chats give agents more autonomy, allowing them to work at their own pace. Set a chat limit to control quality by preventing agents from taking on too many chats at once.
            </p>

            <p style="margin-bottom: 3px"> <strong>Bot </strong></p>
            <p style="color:#999999">
                
                Select a bot that responds automatically.
            </p>
          </div>
        </div>
      </div>
      <!-- /. col-md-4 -->

    </div> 
    <!-- /. row -->
  </div>
  <!-- /. container-fluid -->

</div>
<!-- /. main-content -->

