<div class="navbar-brand" style="z-index: -1;margin-top:10px; padding-left:30px">
    <i class="material-icons" style="vertical-align: middle !important; cursor: pointer;" (click)="goBack()">keyboard_arrow_left</i>
    {{ "ContactDetails" | translate }}
</div>

<div class="main-content" style="padding-top: 0px">
  <div class="container-fluid">

    <div class="row">
  
      <div class="col-md-8">
        <div class="card" style="padding-top:25px; padding-bottom:25px">
          <div class="card-content">


            <loading-spinner *ngIf="showSpinner"></loading-spinner>
            <div  *ngIf="!showSpinner" class="card-content table-responsive">

              <table class="table table-hover">
                <thead class="text">
                  <tr>
                  
                    <th></th>

      
                    <!-- ===== DEPARTMENT NAME ===== -->
                    <th>
                      <span style="color: #566787">
                        <strong>
                          <strong>{{ 'Department' | translate }}</strong>
                        </strong>
                      </span>  
                    </th>

                    <!-- ===== REQUESTER ===== -->
                    <!-- <th>
                      <span style="color: #566787">
                        <strong> 
                          {{ 'HistoryPage.Requester' | translate }}
                        </strong>
                      </span>
                    </th> -->

                    <!-- ===== REQUESTER ID * FOR DEBUG * ===== -->
                    <th>
                      <span style="color: #566787">
                        <strong> Requester Id </strong>
                      </span>
                    </th>

                    <!-- ===== REQUEST FIRST TEXT ===== -->
                    <th>
                      <span style="color: #566787">
                        <strong> 
                          {{ 'Message' | translate }}
                        </strong>
                      </span>
                    </th>

                    <!-- ===== SERVED BY ===== -->
                    <th>
                      <span style="color: #566787">
                        <strong> 
                          {{ 'ServedBy' | translate }}
                        </strong>
                      </span>
                    </th>
                  
                    <!-- ===== RATING ===== -->
                    <th>
                      <span style="color: #566787">
                        <strong> 
                          {{ 'Rating' | translate }}
                        </strong>
                      </span>
                    </th>

    
                    <!-- ===== PUBLISHED ===== -->
                    <th>
                      <span style="color: #566787">
                        <strong> 
                        {{ 'Created' | translate }}
                        </strong>
                      </span>
                    </th>
    
                  </tr>
                </thead>

                <tbody>

                  <!-- ===== IF THERE ISN'T HISTORY REQUEST ===== -->
                  <tr *ngIf="requests_list && requests_list.length === 0"> 
                    <td colspan="7" style="text-align: center; padding-top: 16px; cursor: pointer">

                      <p style="font-size:1em; color:#999999; font-weight: 400">
                        {{ 'HistoryPage.NoRequests' | translate }}
                      </p>
                    </td>
                  </tr> 

                  <tr *ngFor="let request of requests_list">
                    
                    <td style="text-align:center">
  
                      <!-- // CLOSED REQUESTS -->
                      <span *ngIf="request?.status === 1000" (click)='goToRequestMsgs(request?.request_id)'>
                        <!-- pull-right -->
                        <button class="btn btn-default btn-visibility-custom">
                          <i style="font-size: 17px !important; " class="material-icons">visibility</i>
                        </button>
                      </span>

                      <!-- // SERVED REQUESTS -->
                      <span *ngIf="request?.status === 200" (click)='goToRequestMsgs(request?.request_id)'>
                        <button class="btn btn-info btn-visibility-custom">
                          <i style="font-size: 17px !important; " class="material-icons">visibility</i>
                        </button>
                      </span>
                    
                    </td>
                  

                    <!-- ===== DEPARTMENT NAME ===== -->
                    <td>
                      <p style="font-size:0.9em">
                        {{ request?.department?.name }}
                      </p>
                    </td>


                    <!-- ===== REQUESTER ID * FOR DEBUG * ===== -->
                    <td>
                      <p style="font-size:0.8em">
                        {{ request?.requester_id }}
                      </p>
                    </td>

                    <!-- ===== REQUEST FIRST TEXT ===== -->
                    <td (click)='goToRequestMsgs(request?.request_id)' style="cursor:pointer">
                      <p style="font-size:0.9em;" [innerHTML]="getRequestText(request?.first_text)">
                      </p>
                    </td>

                    <!-- ===== SERVED BY ===== -->
                    <td (click)='goToRequestMsgs(request?.request_id)' style="cursor:pointer" >
                      <span *ngFor="let participant of request?.participants"  style="font-size:0.8em;">
                        <span *ngIf="participant !== request?.requester_id && participant !== 'system' && participant !== currentUserID"> 
                          <p class="member" (click)="goToMemberProfile( participant )" [innerHTML]="members_replace( participant )" style="padding-top:1px; padding-bottom:1px; cursor: pointer;">  </p>
                        </span> 
                        <p *ngIf="participant === currentUserID" style="padding-top:1px; padding-bottom:1px;"> 
                          - <strong> 'ME' </strong>
                        </p>
                      </span>
                    </td>
                  
  
                    <!-- ===== RATING ===== -->
                    <td (click)='goToRequestMsgs(request?.request_id)' style="cursor:pointer" >
                      <p *ngIf="request?.rating" style="font-size:0.8em;">
                          {{ request?.rating }} / 5
                      </p>
                      <p *ngIf="!request?.rating" style="font-size:0.8em;">
                          - / 5
                      </p>
                    </td>

    
                    <!-- ===== PUBLISHED ===== -->
                    <td (click)='goToRequestMsgs(request?.request_id)' style="cursor:pointer">
                      <p style="font-size:0.9em">
                        <!-- {{ request?.timestamp | date: 'd/M/y HH:mm:ss'}} -->
                        <!-- {{ request?.request_date_fromnow }} -->
                        <!-- {{ request?.created_on | date: 'd/M/y HH:mm:ss' }} -->
                        {{ request?.createdAt | amTimeAgo }} ({{ request?.createdAt | date: 'd/M/y HH:mm' }}) 
                      </p>
                    </td>

                  </tr>
                </tbody>
              </table>
            </div> <!-- ./ card-content table-responsive -->


          </div>
        </div>
      </div>
      <!-- /. end col-md-8 -->
       
      <!-- ------------============ RIGHT SIDEBAR ============------------ -->
      <div class="col-md-4">
        <div class="card" style="padding-top:25px; padding-bottom:25px">
          <div class="card-content" style="padding-top: 0px;">
            <h4 class="card-title" style="text-transform: none; color: #566787; font-weight:600; margin-bottom: 15px">
              {{ "ContactDetails" | translate }}
            </h4>

            <!-- ------====== ID ======------ -->
            <p style="margin-bottom: 3px">
              <strong>
                Id
              </strong>
            </p>
            <p style="color:#999999">
                {{ contact_details?._id }}
            </p>

            <!-- ------====== CREATED ======------ -->
            <p style="margin-bottom: 3px">
              <strong>
                {{ "Created" | translate }}
              </strong>
            </p>
            <p style="color:#999999">
              {{ contact_details?.createdAt | date: 'd/M/y HH:mm' }}
            </p>

            <!-- ------====== NAME======------ -->
            <p style="margin-bottom: 3px">
              <strong>
                {{ "Name" | translate }}
              </strong>
            </p>
            <p style="color:#999999">
              {{ contact_details?.fullname }}
            </p>

            <!-- ------====== EMAIL ======------ -->
            <p style="margin-bottom: 3px">
              <strong>
                Email
              </strong>
            </p>
            <p style="color:#999999">
              {{ contact_details?.email }}
            </p>
 
          </div>
        </div>
      </div>

    </div>

  </div>
</div>
